<section class="signin-page account">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                <div class="block text-center">
                    <h2 class="text-center">Đổi mật khẩu</h2>
                    <form action="<%=process.env.DOMAIN_API%>/changepassword" method="post" class="text-left clearfix" id="formChangePassword">
                        <% if(err){ %>
                            <div class="alert alert-danger" role="alert">
                                <%= err %>
                            </div>
                            <% } %>
                                <div class="form-group">
                                    <input name="username" required type="text" class="form-control"
                                        placeholder="Tài khoản">
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="button dark text-center">Gửi yêu cầu</button>
                                </div>
                    </form>
                    <p class="mt-20">Bạn Chưa Có Tài Khoản ?<a href="/account/register"> Tạo Tài Khoản</a></p>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="<%= process.env.DOMAIN_NAME %>/assets/vendor/libs/jquery/jquery.js"></script>
<script>
    $("#formChangePassword").submit(function (e) {
        e.preventDefault();
        var form = $(this);
        var actionUrl = form.attr('action');

        $.ajax({
            type: "POST",
            url: actionUrl,
            data: form.serialize(),
            dataType: 'json',
            success: function (data) {
                console.log(data);
                if (data.status == 'error') {
                    Swal.fire({
                        title: "Oops...",
                        text: data.info.message,
                        icon: "error",
                        timer: 1000
                    });
                } else {
                        Swal.fire({
                            icon: 'success',
                            title: 'Link đổi mật khẩu sẽ dược gửi đến email của bạn',
                            showConfirmButton: true
                        })
                }
            },
            error: function (error) {
                console.log('lỗi');
            }
        });
    });
</script>